
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="AsyncIO MongoDB ODM (Object Document Mapper) using python type hinting">
      
      
      
        <link rel="canonical" href="https://art049.github.io/odmantic/usage_fastapi/">
      
      
        <link rel="prev" href="../raw_query_usage/">
      
      
        <link rel="next" href="../usage_pydantic/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.14">
    
    
      
        <title>Usage with FastAPI - ODMantic</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.10ba22f1.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","UA-180814888-1"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","UA-180814888-1",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=UA-180814888-1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#usage-with-fastapi" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ODMantic" class="md-header__button md-logo" aria-label="ODMantic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.5 9.63c-.19-2.79-1.32-5.51-3.44-7.63A12.253 12.253 0 0 0 8.5 9.63c1.29.68 2.47 1.56 3.5 2.63a14.22 14.22 0 0 1 3.5-2.63M12 15.45C9.85 12.17 6.18 10 2 10c0 10 9.32 11.89 10 12 .68-.12 10-2 10-12-4.18 0-7.85 2.17-10 5.45Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ODMantic
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Usage with FastAPI
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/art049/odmantic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    art049/odmantic
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ODMantic" class="md-nav__button md-logo" aria-label="ODMantic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.5 9.63c-.19-2.79-1.32-5.51-3.44-7.63A12.253 12.253 0 0 0 8.5 9.63c1.29.68 2.47 1.56 3.5 2.63a14.22 14.22 0 0 1 3.5-2.63M12 15.45C9.85 12.17 6.18 10 2 10c0 10 9.32 11.89 10 12 .68-.12 10-2 10-12-4.18 0-7.85 2.17-10 5.45Z"/></svg>

    </a>
    ODMantic
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/art049/odmantic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    art049/odmantic
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fields
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../modeling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modeling
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../engine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Engine
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../querying/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Querying
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../raw_query_usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Raw query usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Usage with FastAPI
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Usage with FastAPI
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defining-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Defining the model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-the-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Building the engine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-all-the-trees" class="md-nav__link">
    <span class="md-ellipsis">
      Getting all the trees
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#counting-the-trees" class="md-nav__link">
    <span class="md-ellipsis">
      Counting the trees
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-a-tree-by-id" class="md-nav__link">
    <span class="md-ellipsis">
      Getting a tree by id
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extending-the-example" class="md-nav__link">
    <span class="md-ellipsis">
      Extending the example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extending the example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deleting-a-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Deleting a tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-a-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Updating a tree
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upcoming-features" class="md-nav__link">
    <span class="md-ellipsis">
      Upcoming features
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage_pydantic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage with Pydantic
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    odmantic.model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/engine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    odmantic.engine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    odmantic.session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    odmantic.query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/field/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    odmantic.field
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    odmantic.reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    odmantic.index
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/bson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    odmantic.bson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    odmantic.exceptions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    odmantic.config
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../migration_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migration Guide
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defining-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Defining the model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-the-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Building the engine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-all-the-trees" class="md-nav__link">
    <span class="md-ellipsis">
      Getting all the trees
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#counting-the-trees" class="md-nav__link">
    <span class="md-ellipsis">
      Counting the trees
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-a-tree-by-id" class="md-nav__link">
    <span class="md-ellipsis">
      Getting a tree by id
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extending-the-example" class="md-nav__link">
    <span class="md-ellipsis">
      Extending the example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extending the example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deleting-a-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Deleting a tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-a-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Updating a tree
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upcoming-features" class="md-nav__link">
    <span class="md-ellipsis">
      Upcoming features
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="usage-with-fastapi">Usage with FastAPI<a class="headerlink" href="#usage-with-fastapi" title="Permanent link">&para;</a></h1>
<h2 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h2>
<p>In this example, we create a minimalist REST API describing trees by their name, average size and discovery year.</p>
<div class="admonition info">
<p class="admonition-title">Requirements</p>
<p>To run the following example, you'll need to install FastAPI and Uvicorn.
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>fastapi<span class="w"> </span>uvicorn
</code></pre></div></p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">HTTPException</span>

<span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">AIOEngine</span><span class="p">,</span> <span class="n">Model</span><span class="p">,</span> <span class="n">ObjectId</span>


<span class="k">class</span> <span class="nc">Tree</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">average_size</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">discovery_year</span><span class="p">:</span> <span class="nb">int</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">AIOEngine</span><span class="p">()</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s2">&quot;/trees/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">Tree</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">create_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">:</span> <span class="n">Tree</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/trees/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">List</span><span class="p">[</span><span class="n">Tree</span><span class="p">])</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_trees</span><span class="p">():</span>
    <span class="n">trees</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Tree</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">trees</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/trees/count&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">count_trees</span><span class="p">():</span>
    <span class="n">count</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">Tree</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">count</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/trees/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">Tree</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_tree_by_id</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">):</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">Tree</span><span class="p">,</span> <span class="n">Tree</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree</span>
</code></pre></div></td></tr></table></div>
<p>You can then start the application. For example if you saved the file above in a file
named <code>tree_api.py</code>:
<div class="highlight"><pre><span></span><code><span class="n">uvicorn</span> <span class="n">tree_api</span><span class="p">:</span><span class="n">app</span>
</code></pre></div></p>
<p>Uvicorn should start serving the API locally:</p>
<div class="highlight"><pre><span></span><code>INFO:     Started server process [21429]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://localhost:8080 (Press CTRL+C to quit)
</code></pre></div>
<p>To try it out, you can simply access the interactive documentation generated by FastAPI
at <a href="http://localhost:8080/docs" target="blank_">http://localhost:8080/docs</a>.</p>
<p><img align="left" alt="Swagger for the created Tree API" src="../img/usage_fastapi_swagger.png" /></p>
<p>We'll now dive in the details of this example.</p>
<h3 id="defining-the-model">Defining the model<a class="headerlink" href="#defining-the-model" title="Permanent link">&para;</a></h3>
<p>First, we create our <code>Tree</code> model.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Tree</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">average_size</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">discovery_year</span><span class="p">:</span> <span class="nb">int</span>
</code></pre></div>
<p>This describes our <code>Tree</code> instances structure both for JSON serialization and for the
storage in the MongoDB collection.</p>
<h3 id="building-the-engine">Building the engine<a class="headerlink" href="#building-the-engine" title="Permanent link">&para;</a></h3>
<p>After having defined the model, we create the <a class="autorefs autorefs-internal" href="../api_reference/engine/#odmantic.engine.AIOEngine">AIOEngine</a>
object. This object will be responsible for performing database operations.</p>
<div class="highlight"><pre><span></span><code><span class="n">engine</span> <span class="o">=</span> <span class="n">AIOEngine</span><span class="p">()</span>
</code></pre></div>
<p>It's possible as well to build the engine with custom parameters (mongo URI,
database name). See <a href="../engine/#creating-the-engine">this section</a> for more details.</p>
<div class="admonition tip">
<p class="admonition-title">Running the python file directly</p>
<p>If you need to execute the python file directly with the interpreter (to use a
debugger for example), some extra steps will be required.</p>
<p>Run <code>uvicorn</code> using the default event loop (if the file is called directly):
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">asyncio</span>
    <span class="kn">import</span> <span class="nn">uvicorn</span>
    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">uvicorn</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">)</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">uvicorn</span><span class="o">.</span><span class="n">Server</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">server</span><span class="o">.</span><span class="n">serve</span><span class="p">())</span>
</code></pre></div></p>
<details class="info">
<summary><code>uvicorn.run</code> behavior with event loops (Advanced)</summary>
<p>The usual entrypoint <code>uvicorn.run(app)</code> for ASGI apps doesn't work because when
called <code>uvicorn</code> will create and run a brand <strong>new</strong> event loop.</p>
<p>Thus, the engine object will be bound to a different event loop that will not be
running. In this case, you'll witness <code>&lt;Future pending&gt; attached to a different
loop</code> errors because the app itself will be running in a different event loop
than the engine's driver.</p>
<p>Anyway, when running directly the app through the <code>uvicorn</code> CLI, the default
event loop will be the one that will be running later, so no modifications are
required.</p>
</details>
</div>
<div class="admonition warning">
<p class="admonition-title">AIOEngineDependency deprecation (from v0.2.0)</p>
<p>The <code>AIOEngineDependency</code> that was used to inject the engine in the API routes is
now deprecated (it will be kept for few versions though).</p>
<p>Using a global engine object should be preferred as it will dramatically reduce the
required verbosity to use the engine in an endpoint.</p>
<p>If you need to run your <code>app</code> directly from a python file, see the above <strong>Running the
python file directly</strong> section.</p>
</div>
<h3 id="creating-a-tree">Creating a tree<a class="headerlink" href="#creating-a-tree" title="Permanent link">&para;</a></h3>
<p>The next step is to define a route enabling us to create a new tree. To that end, we
create a <code>PUT</code> route with the path <code>/trees/</code>. This endpoint will receive a tree,
persist it to the database and return the created object.</p>
<p><div class="highlight"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s2">&quot;/trees/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">Tree</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">create_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">:</span> <span class="n">Tree</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree</span>
</code></pre></div>
First, the request body will be parsed to a <code>Tree</code> object (this is done by
specifying the argument <code>tree: Tree</code>). This mean that the model validation will be
performed. Once the model is parsed to a Tree instance, we persist it to the
database and we return it.</p>
<details class="tip" open="open">
<summary>Command line tool for interacting with JSON based HTTP APIs</summary>
<p>To interact with the API from the command line, we recommend to use the
<a href="https://httpie.org/" target="blank_">HTTPie</a> CLI.</p>
<p>The next examples are still provided with the <code>curl</code> syntax since the Swagger
 documentation generated by FastAPI will give you curl examples directly.</p>
</details>
<div class="admonition example">
<p class="admonition-title">Creating a Tree from the command line</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">HTTPie</label><label for="__tabbed_1_2">curl</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Send the request:
<div class="highlight"><pre><span></span><code>http<span class="w"> </span>PUT<span class="w"> </span>localhost:8080/trees/<span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Spruce&quot;</span><span class="w"> </span><span class="nv">discovery_year</span><span class="o">=</span><span class="m">1995</span><span class="w"> </span><span class="nv">average_size</span><span class="o">=</span><span class="m">2</span>
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>HTTP/1.1 200 OK
content-length: 90
content-type: application/json
date: Sun, 18 Oct 2020 18:40:30 GMT
server: uvicorn

{
    &quot;average_size&quot;: 2.0,
    &quot;discovery_year&quot;: 1995,
<span class="hll">    &quot;id&quot;: &quot;5f8c8c1ff1d33aa1012f3086&quot;,
</span>    &quot;name&quot;: &quot;Spruce&quot;
}
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Send the request:
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span><span class="s2">&quot;http://localhost:8080/trees/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w">  </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;name&quot;:&quot;Spruce&quot;, &quot;discovery_year&quot;:1995, &quot;average_size&quot;:2}&#39;</span>
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>{&quot;name&quot;:&quot;Spruce&quot;,&quot;average_size&quot;:2.0,&quot;discovery_year&quot;:1995,&quot;id&quot;:&quot;5f8c8c1ff1d33aa1012f3086&quot;}
</code></pre></div></p>
</div>
</div>
</div>
<p>You can notice that the <code>id</code> field has been added automatically by ODMantic.
This <code>id</code> field is actually not required since it's defined automatically by ODMantic
with a default factory method (<a href="../fields/#the-id-field">more details</a>).</p>
<p>You can still specify this field in the request body to predefine the <code>id</code> of the
created instance or to overwrite an existing instance.</p>
</div>
<div class="admonition question">
<p class="admonition-title">Why <code>PUT</code> instead of <code>POST</code> ?</p>
<p>Since the <code>engine.save</code> behave as an upsert operation (<a href="../engine/#update">more
details</a>), you can overwrite instances stored in the database
 by creating a new instance with the same id and calling the <code>engine.save</code> method.</p>
<details class="example">
<summary>Modifying the Tree from the command line</summary>
<p>To overwrite the tree with <code>id=5f8c8c1ff1d33aa1012f3086</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">HTTPie</label><label for="__tabbed_2_2">curl</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Send the request:
<div class="highlight"><pre><span></span><code>http<span class="w"> </span>PUT<span class="w"> </span>localhost:8080/trees/<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Norway Spruce&quot;</span><span class="w"> </span><span class="nv">discovery_year</span><span class="o">=</span><span class="m">1795</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">average_size</span><span class="o">=</span><span class="m">200</span><span class="w"> </span><span class="nv">id</span><span class="o">=</span><span class="s2">&quot;5f8c8c1ff1d33aa1012f3086&quot;</span>
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>HTTP/1.1 200 OK
content-length: 90
content-type: application/json
date: Sun, 18 Oct 2020 18:40:30 GMT
server: uvicorn

{
    &quot;average_size&quot;: 200.0,
    &quot;discovery_year&quot;: 1795,
    &quot;id&quot;: &quot;5f8c8c1ff1d33aa1012f3086&quot;,
<span class="hll">    &quot;name&quot;: &quot;Norway Spruce&quot;
</span>}
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Send the request:
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span><span class="s2">&quot;http://localhost:8080/trees/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w">  </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;name&quot;:&quot;Norway Spruce&quot;, &quot;discovery_year&quot;:1795,</span>
<span class="s1">          &quot;average_size&quot;:200, &quot;id&quot;:&quot;5f8c8c1ff1d33aa1012f3086&quot;}&#39;</span>
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>{&quot;name&quot;:&quot;Norway Spruce&quot;,&quot;average_size&quot;:200.0,&quot;discovery_year&quot;:1795,&quot;id&quot;:&quot;5f8c8c1ff1d33aa1012f3086&quot;}
</code></pre></div></p>
</div>
</div>
</div>
</details>
<p>Since we can modify an existing instance, it makes more sense to define the
 operation as a <code>PUT</code> instead of a <code>POST</code> that should create a new resource on each
 call.</p>
</div>
<p>If the request body doesn't match our model schema, a <code>422
Unprocessable Entity</code> error will be returned by the API, containing the details about
the error.</p>
<div class="admonition example">
<p class="admonition-title">Invalid data while creating the Tree from the command line</p>
<p>You can try by omitting the <code>average_size</code> field:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">HTTPie</label><label for="__tabbed_3_2">curl</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Send the request:
<div class="highlight"><pre><span></span><code>http<span class="w"> </span>PUT<span class="w"> </span>localhost:8080/trees/<span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Spruce&quot;</span><span class="w"> </span><span class="nv">discovery_year</span><span class="o">=</span><span class="m">1995</span>
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code><span class="hll">HTTP/1.1 422 Unprocessable Entity
</span>content-length: 96
content-type: application/json
date: Sun, 18 Oct 2020 16:42:18 GMT
server: uvicorn

{
    &quot;detail&quot;: [
        {
            &quot;loc&quot;: [
                &quot;body&quot;,
<span class="hll">                &quot;average_size&quot;
</span>            ],
<span class="hll">            &quot;msg&quot;: &quot;field required&quot;,
</span>            &quot;type&quot;: &quot;value_error.missing&quot;
        }
    ]
}
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Send the request:
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-v<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span><span class="s2">&quot;http://localhost:8080/trees/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w">  </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;name&quot;:&quot;Spruce&quot;, &quot;discovery_year&quot;:1995}&#39;</span>
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>*   Trying 127.0.0.1...
* TCP_NODELAY set
* Connected to localhost (127.0.0.1) port 8080 (#0)
&gt; PUT /trees/ HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.58.0
&gt; Accept: */*
&gt; Content-Type: application/json
&gt; Content-Length: 40
&gt;
* upload completely sent off: 40 out of 40 bytes
<span class="hll">&lt; HTTP/1.1 422 Unprocessable Entity
</span>&lt; date: Sun, 18 Oct 2020 18:51:33 GMT
&lt; server: uvicorn
&lt; content-length: 96
&lt; content-type: application/json
&lt;
* Connection #0 to host localhost left intact
<span class="hll">{&quot;detail&quot;:[{&quot;loc&quot;:[&quot;body&quot;,&quot;average_size&quot;],&quot;msg&quot;:&quot;field required&quot;,&quot;type&quot;:&quot;value_error.missing&quot;}]}%
</span></code></pre></div></p>
</div>
</div>
</div>
<p>The validation error structure is the one that is defined by the <a href="https://docs.pydantic.dev/latest/usage/models/#error-handling" target="blank_">Pydantic:
 ValidationError</a>
 exception.</p>
</div>
<p>Finally, specifying the <code>response_model</code> in the <code>app.put</code> decorator is not
mandatory but it is strongly advised as it helps FastAPI to generate the documentation.</p>
<h3 id="getting-all-the-trees">Getting all the trees<a class="headerlink" href="#getting-all-the-trees" title="Permanent link">&para;</a></h3>
<p>To get the trees stored in the database, we use the
<a class="autorefs autorefs-internal" href="../api_reference/engine/#odmantic.engine.AIOEngine.find">AIOEngine.find</a> method in its <code>awaitable</code> form (<a href="../engine/#fetch-multiple-instances">more
details</a>), this gives us directly the list of Tree
instances that we can return directly:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/trees/&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">List</span><span class="p">[</span><span class="n">Tree</span><span class="p">])</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_trees</span><span class="p">():</span>
    <span class="n">trees</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Tree</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">trees</span>
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Creating and getting the trees from the command line</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">HTTPie</label><label for="__tabbed_4_2">curl</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Create some trees:
<div class="highlight"><pre><span></span><code>http<span class="w"> </span>PUT<span class="w"> </span>localhost:8080/trees/<span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Spruce&quot;</span><span class="w"> </span><span class="nv">discovery_year</span><span class="o">=</span><span class="m">1995</span><span class="w"> </span><span class="nv">average_size</span><span class="o">=</span><span class="m">10</span>.2
http<span class="w"> </span>PUT<span class="w"> </span>localhost:8080/trees/<span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Pine&quot;</span><span class="w"> </span><span class="nv">discovery_year</span><span class="o">=</span><span class="m">1850</span><span class="w"> </span><span class="nv">average_size</span><span class="o">=</span><span class="m">5</span>
</code></pre></div></p>
<p>Get the trees:
<div class="highlight"><pre><span></span><code>http<span class="w"> </span>localhost:8080/trees/
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>HTTP/1.1 200 OK
content-length: 270
content-type: application/json
date: Sun, 18 Oct 2020 17:59:10 GMT
server: uvicorn

[
    {
        &quot;average_size&quot;: 10.2,
        &quot;discovery_year&quot;: 1995,
        &quot;id&quot;: &quot;5f8c8266f1d33aa1012f3082&quot;,
        &quot;name&quot;: &quot;Spruce&quot;
    },
    {
        &quot;average_size&quot;: 5.0,
        &quot;discovery_year&quot;: 1850,
        &quot;id&quot;: &quot;5f8c8266f1d33aa1012f3083&quot;,
        &quot;name&quot;: &quot;Pine&quot;
    }
]
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Create some trees:
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-v<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span><span class="s2">&quot;http://localhost:8080/trees/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w">  </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;name&quot;:&quot;Spruce&quot;, &quot;discovery_year&quot;:1995, &quot;average_size&quot;:10.2}&#39;</span>
curl<span class="w"> </span>-v<span class="w">  </span>-X<span class="w"> </span>PUT<span class="w"> </span><span class="s2">&quot;http://localhost:8080/trees/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w">  </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;name&quot;:&quot;Pine&quot;, &quot;discovery_year&quot;:1850, &quot;average_size&quot;:5}&#39;</span>
</code></pre></div>
Get the trees:
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>http://localhost:8080/trees/<span class="w"> </span><span class="p">|</span><span class="w"> </span>python<span class="w"> </span>-mjson.tool
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>[
    {
        &quot;name&quot;: &quot;Spruce&quot;,
        &quot;average_size&quot;: 10.2,
        &quot;discovery_year&quot;: 1995,
        &quot;id&quot;: &quot;5f8c8266f1d33aa1012f3082&quot;
    },
    {
        &quot;name&quot;: &quot;Pine&quot;,
        &quot;average_size&quot;: 5.0,
        &quot;discovery_year&quot;: 1850,
        &quot;id&quot;: &quot;5f8c8266f1d33aa1012f3083&quot;
    }
]
</code></pre></div></p>
</div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Pagination</p>
<p>You can add pagination to this <code>GET</code> request by using the <code>skip</code> and <code>limit</code>
arguments while calling the <a class="autorefs autorefs-internal" href="../api_reference/engine/#odmantic.engine.AIOEngine.find">AIOEngine.find</a> method.</p>
</div>
<h3 id="counting-the-trees">Counting the trees<a class="headerlink" href="#counting-the-trees" title="Permanent link">&para;</a></h3>
<p>To get the number of trees stored in the database, we use the
<a class="autorefs autorefs-internal" href="../api_reference/engine/#odmantic.engine.AIOEngine.count">AIOEngine.count</a> method without specifying any query
parameters (to directly get the total count of instances).</p>
<div class="highlight"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/trees/count&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">count_trees</span><span class="p">():</span>
    <span class="n">count</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">Tree</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">count</span>
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Getting the tree count from the command line</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">HTTPie</label><label for="__tabbed_5_2">curl</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Get the count:
<div class="highlight"><pre><span></span><code>http<span class="w"> </span>localhost:8080/trees/count
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>HTTP/1.1 200 OK
content-length: 1
content-type: application/json
date: Sun, 18 Oct 2020 20:16:50 GMT
server: uvicorn

<span class="hll">2
</span></code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Get the count:
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>http://localhost:8080/trees/count
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>2
</code></pre></div></p>
</div>
</div>
</div>
</div>
<h3 id="getting-a-tree-by-id">Getting a tree by <code>id</code><a class="headerlink" href="#getting-a-tree-by-id" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/trees/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">Tree</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_tree_by_id</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">,</span> <span class="p">):</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">Tree</span><span class="p">,</span> <span class="n">Tree</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree</span>
</code></pre></div>
<p>To return a tree from its <code>id</code> we add a path parameter <code>id: ObjectId</code>. Once this
endpoint is called, FastAPI will try to validate this query parameter, thus inferring an
<code>ObjectId</code> object.</p>
<div class="admonition warning">
<p class="admonition-title">Using BSON objects as parameters</p>
<p>While you can define ODMantic models directly using <code>bson</code> fields (<a href="../fields/#bson-types-integration">more
details</a>), it's not possible to use those types
directly with FastAPI, you'll need to get the equivalent objects from the
<a href="../api_reference/bson/">odmantic.bson</a> module. Those equivalent types implement the
additional validation logic enabling FastAPI to work with them.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">odmantic.bson</span> <span class="kn">import</span> <span class="n">ObjectId</span>
</code></pre></div>
<p>For convenience reasons, the <code>ObjectId</code> type including the validation logic is as
well available directly from the <code>odmantic</code> module.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">ObjectId</span>
</code></pre></div>
</div>
<p>With this <code>ObjectId</code>, we build a query that will filter only the instances having this
exactly same <code>id</code>:
<div class="highlight"><pre><span></span><code><span class="n">Tree</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="nb">id</span>
</code></pre></div>
Then, we pass this query to the <a class="autorefs autorefs-internal" href="../api_reference/engine/#odmantic.engine.AIOEngine.find_one">AIOEngine.find_one</a> method that will try to return an instance, otherwise <code>None</code> will be returned:
<div class="highlight"><pre><span></span><code><span class="n">tree</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">Tree</span><span class="p">,</span> <span class="n">Tree</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">)</span>
</code></pre></div>
Now, if our tree object is None (i.e the instance has not been found), we need to return
a <code>404 Not Found</code> error:
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
</code></pre></div>
Otherwise, we found the requested instance. We can return it !
<div class="highlight"><pre><span></span><code><span class="k">return</span> <span class="n">tree</span>
</code></pre></div></p>
<div class="admonition example">
<p class="admonition-title">Getting a tree from the command line</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">HTTPie</label><label for="__tabbed_6_2">curl</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Get the tree <code>5f8c8266f1d33aa1012f3082</code>:
<div class="highlight"><pre><span></span><code>http<span class="w"> </span>localhost:8080/trees/5f8c8266f1d33aa1012f3082
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>HTTP/1.1 200 OK
content-length: 91
content-type: application/json
date: Sun, 18 Oct 2020 21:08:07 GMT
server: uvicorn

{
    &quot;average_size&quot;: 10.2,
    &quot;discovery_year&quot;: 1995,
<span class="hll">    &quot;id&quot;: &quot;5f8c8266f1d33aa1012f3082&quot;,
</span>    &quot;name&quot;: &quot;Spruce&quot;
}
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Get the tree <code>5f8c8266f1d33aa1012f3082</code>:</p>
<p><div class="highlight"><pre><span></span><code>curl<span class="w"> </span>http://localhost:8080/trees/5f8c8266f1d33aa1012f3082
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>{&quot;name&quot;:&quot;Spruce&quot;,&quot;average_size&quot;:10.2,&quot;discovery_year&quot;:1995,&quot;id&quot;:&quot;5f8c8266f1d33aa1012f3082&quot;}
</code></pre></div></p>
</div>
</div>
</div>
</div>
<div class="admonition example">
<p class="admonition-title">Trying to get a tree not in the database from the command line</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">HTTPie</label><label for="__tabbed_7_2">curl</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Try to get the tree <code>f0f0f0f0f0f0f0f0f0f0f0f0</code> (it has not been created):
<div class="highlight"><pre><span></span><code>http<span class="w"> </span>localhost:8080/trees/f0f0f0f0f0f0f0f0f0f0f0f0
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code><span class="hll">HTTP/1.1 404 Not Found
</span>content-length: 22
content-type: application/json
date: Sun, 18 Oct 2020 21:11:48 GMT
server: uvicorn

{
<span class="hll">    &quot;detail&quot;: &quot;Not Found&quot;
</span>}
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Try to get the tree <code>f0f0f0f0f0f0f0f0f0f0f0f0</code> (it has not been created):
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>http://localhost:8080/trees/f0f0f0f0f0f0f0f0f0f0f0f0
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>{&quot;detail&quot;:&quot;Not Found&quot;}
</code></pre></div></p>
</div>
</div>
</div>
</div>
<p>This <code>id</code> path parameter should be a 16 characters hexadecimal string (see <a href="https://docs.mongodb.com/manual/reference/method/ObjectId/" target="blank_">MongoDB:
ObjectId</a>
for more details). If the <code>id</code> specified in the path does not match this criteria, a <code>422
Unprocessable Entity</code> error will be returned:</p>
<div class="admonition example">
<p class="admonition-title">Trying to get a tree with an invalid <code>id</code> from the command line</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">HTTPie</label><label for="__tabbed_8_2">curl</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Get the tree identified by <code>invalid_object_id</code>:
<div class="highlight"><pre><span></span><code>http<span class="w"> </span>localhost:8080/trees/invalid_object_id
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code><span class="hll">HTTP/1.1 422 Unprocessable Entity
</span>content-length: 89
content-type: application/json
date: Sun, 18 Oct 2020 20:50:25 GMT
server: uvicorn

{
    &quot;detail&quot;: [
        {
            &quot;loc&quot;: [
<span class="hll">                &quot;path&quot;,
</span><span class="hll">                &quot;id&quot;
</span>            ],
<span class="hll">            &quot;msg&quot;: &quot;invalid ObjectId specified&quot;,
</span>            &quot;type&quot;: &quot;type_error&quot;
        }
    ]
}
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Get the tree identified by <code>invalid_object_id</code>:</p>
<p><div class="highlight"><pre><span></span><code>curl<span class="w"> </span>http://localhost:8080/trees/invalid_object_id
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>{&quot;detail&quot;:[{&quot;loc&quot;:[&quot;path&quot;,&quot;id&quot;],&quot;msg&quot;:&quot;invalid ObjectId specified&quot;,&quot;type&quot;:&quot;type_error&quot;}]}
</code></pre></div></p>
</div>
</div>
</div>
</div>
<h2 id="extending-the-example">Extending the example<a class="headerlink" href="#extending-the-example" title="Permanent link">&para;</a></h2>
<h3 id="deleting-a-tree">Deleting a tree<a class="headerlink" href="#deleting-a-tree" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">uvicorn</span>
<span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">HTTPException</span>

<span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">AIOEngine</span><span class="p">,</span> <span class="n">Model</span><span class="p">,</span> <span class="n">ObjectId</span>


<span class="k">class</span> <span class="nc">Tree</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">average_size</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">discovery_year</span><span class="p">:</span> <span class="nb">int</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">AIOEngine</span><span class="p">()</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/trees/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">Tree</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_tree_by_id</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">):</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">Tree</span><span class="p">,</span> <span class="n">Tree</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree</span>


<span class="hll"><span class="nd">@app</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;/trees/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">Tree</span><span class="p">)</span>
</span><span class="hll"><span class="k">async</span> <span class="k">def</span> <span class="nf">delete_tree_by_id</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">):</span>
</span><span class="hll">    <span class="n">tree</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">Tree</span><span class="p">,</span> <span class="n">Tree</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">)</span>
</span><span class="hll">    <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span class="hll">        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
</span><span class="hll">    <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</span><span class="hll">    <span class="k">return</span> <span class="n">tree</span>
</span></code></pre></div></td></tr></table></div>
<p>This new <code>DELETE</code> route is strongly inspired from the one used to <a href="#getting-a-tree-by-id">get a tree from its
<code>id</code></a>.</p>
<p>Currently, ODMantic can only delete an instance and it's not possible to perform a
delete operation from a query filter. Thus, we first need to get the associated
instance. Once we have the instance, we call the
<a class="autorefs autorefs-internal" href="../api_reference/engine/#odmantic.engine.AIOEngine.delete">AIOEngine.delete</a> method to perform the deletion.</p>
<div class="admonition example">
<p class="admonition-title">Deleting a tree from the command line</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">HTTPie</label><label for="__tabbed_9_2">curl</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Delete the tree identified by <code>5f8c8266f1d33aa1012f3082</code>:
<div class="highlight"><pre><span></span><code>http<span class="w"> </span>DELETE<span class="w"> </span>localhost:8080/trees/5f8c8266f1d33aa1012f3082
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code><span class="hll">HTTP/1.1 200 OK
</span>content-length: 91
content-type: application/json
date: Sun, 18 Oct 2020 21:35:22 GMT
server: uvicorn

{
    &quot;average_size&quot;: 10.2,
    &quot;discovery_year&quot;: 1995,
    &quot;id&quot;: &quot;5f8c8266f1d33aa1012f3082&quot;,
    &quot;name&quot;: &quot;Spruce&quot;
}
</code></pre></div></p>
<p>Check that the tree is not stored anymore:</p>
<p><div class="highlight"><pre><span></span><code>http<span class="w"> </span>localhost:8080/trees/5f8c8266f1d33aa1012f3082
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code><span class="hll">HTTP/1.1 404 Not Found
</span>content-length: 22
content-type: application/json
date: Sun, 18 Oct 2020 21:36:45 GMT
server: uvicorn

{
<span class="hll">    &quot;detail&quot;: &quot;Not Found&quot;
</span>}
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Delete the tree identified by <code>5f8c8266f1d33aa1012f3082</code>:
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-X<span class="w"> </span>DELETE<span class="w"> </span>http://localhost:8080/trees/5f8c8266f1d33aa1012f3082
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>{&quot;name&quot;:&quot;Spruce&quot;,&quot;average_size&quot;:10.2,&quot;discovery_year&quot;:1995,&quot;id&quot;:&quot;5f8c8266f1d33aa1012f3082&quot;}
</code></pre></div>
Check that the tree is not stored anymore:
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>http://localhost:8080/trees/5f8c8266f1d33aa1012f3082
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>{&quot;detail&quot;:&quot;Not Found&quot;}
</code></pre></div></p>
</div>
</div>
</div>
<p>The tree has been removed successfully !</p>
</div>
<h3 id="updating-a-tree">Updating a tree<a class="headerlink" href="#updating-a-tree" title="Permanent link">&para;</a></h3>
<p>We already defined a <code>PUT</code> route that enables us to modify (replace) a tree instance.
However, with this previous implementation, it's not possible to specify only the
fields that we want to change as the whole Tree instance is rebuilt from the request's
body.</p>
<p>In this example, we will define a <code>PATCH</code> method that will allow us to modify only some
specific fields of a Tree instance:</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">HTTPException</span>
<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span>

<span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">AIOEngine</span><span class="p">,</span> <span class="n">Model</span><span class="p">,</span> <span class="n">ObjectId</span>


<span class="k">class</span> <span class="nc">Tree</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">average_size</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">discovery_year</span><span class="p">:</span> <span class="nb">int</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">AIOEngine</span><span class="p">()</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/trees/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">Tree</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_tree_by_id</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">):</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">Tree</span><span class="p">,</span> <span class="n">Tree</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree</span>


<span class="hll"><span class="k">class</span> <span class="nc">TreePatchSchema</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span class="hll">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span class="hll">    <span class="n">average_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span class="hll">    <span class="n">discovery_year</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span>

<span class="hll"><span class="nd">@app</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="s2">&quot;/trees/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">Tree</span><span class="p">)</span>
</span><span class="hll"><span class="k">async</span> <span class="k">def</span> <span class="nf">update_tree_by_id</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">,</span> <span class="n">patch</span><span class="p">:</span> <span class="n">TreePatchSchema</span><span class="p">):</span>
</span><span class="hll">    <span class="n">tree</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">Tree</span><span class="p">,</span> <span class="n">Tree</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">)</span>
</span><span class="hll">    <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span class="hll">        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
</span><span class="hll">    <span class="n">tree</span><span class="o">.</span><span class="n">model_update</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
</span><span class="hll">    <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</span><span class="hll">    <span class="k">return</span> <span class="n">tree</span>
</span></code></pre></div></td></tr></table></div>
First, we define the <code>TreePatchSchema</code> this Pydantic model will contain the
modifications that we need to apply on the instance. Since we want to be able to update
each field independently, we give each of them the <code>None</code> default value.</p>
<p>Then, we configure a new <code>PATCH</code> endpoint by setting the <code>id</code> of the model to update
as a path parameter and the <code>TreePatchSchema</code> as the request body parameter.</p>
<p>After all the parameters have been validated properly and the appropriate instance have
been gathered, we can apply the modifications to the local instance using the
<a class="autorefs autorefs-internal" href="../api_reference/model/#odmantic.model._BaseODMModel.model_update">Model.model_update</a> method. By default, the update
method will replace each field values in the instance with the ones explicitely set in
the patch object. Thus, the fields containing the None default values are not gonna be
changed in the instance.</p>
<p>We can then finish by saving and returning the updated tree.</p>
<details class="tip">
<summary>Optional, defaults, non-required and required pydantic fields (advanced)</summary>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span>

<span class="k">class</span> <span class="nc">M</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">c</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">d</span><span class="p">:</span> <span class="nb">int</span>
</code></pre></div>
<p>In this example, fields have a different behavior:</p>
<dl>
<dt><code class="highlight"><span class="n">a</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code></dt>
<dd>this field is <strong>not required</strong>, <code>None</code> is its default value, it can be given
  <code>None</code> or any <code>int</code> values</dd>
<dt><code class="highlight"><span class="n">b</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code></dt>
<dd>same behavior as <code>a</code> since <code>None</code> is set automatically as the default value for
  <code>typing.Optional</code> fields</dd>
<dt><code class="highlight"><span class="n">c</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span></code></dt>
<dd>this field is <strong>not required</strong>, if not explicitely provided it will take the
  <code>None</code> value, <strong>only</strong> an <code>int</code> can be given as an explicit value</dd>
<dt><code class="highlight"><span class="n">d</span><span class="p">:</span> <span class="nb">int</span></code></dt>
<dd>this field is <strong>required</strong> and an <code>int</code> value <strong>must</strong> be provided</dd>
</dl>
<p>(More details: <a href="https://github.com/samuelcolvin/pydantic/issues/1223#issuecomment-594632324" target="blank_">pydantic #1223</a>,
 <a href="https://docs.pydantic.dev/latest/usage/models/#required-fields" target="blank_">pydantic: Required fields</a>)</p>
<p>By default <a class="autorefs autorefs-internal" href="../api_reference/model/#odmantic.model._BaseODMModel.model_update">Model.model_update</a>, will not apply
values from unset (not explicitely populated) fields. Since we don't want to allow
explicitely set <code>None</code> values in the example, we used fields defined as
<code class="highlight"><span class="n">c</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span></code>.</p>
</details>
<div class="admonition example">
<p class="admonition-title">Updating a tree from the command line</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">HTTPie</label><label for="__tabbed_10_2">curl</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Update the tree identified by <code>5f8c8266f1d33aa1012f3083</code>:
<div class="highlight"><pre><span></span><code>http<span class="w"> </span>PATCH<span class="w"> </span>localhost:8080/trees/5f8c8266f1d33aa1012f3083<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">discovery_year</span><span class="o">=</span><span class="m">1825</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Stone Pine&quot;</span>
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code><span class="hll">HTTP/1.1 200 OK
</span>content-length: 94
content-type: application/json
date: Sun, 18 Oct 2020 22:02:44 GMT
server: uvicorn

{
    &quot;average_size&quot;: 5.0,
    &quot;discovery_year&quot;: 1825,
    &quot;id&quot;: &quot;5f8c8266f1d33aa1012f3083&quot;,
    &quot;name&quot;: &quot;Stone Pine&quot;
}
</code></pre></div></p>
<p>Check that the tree has been updated properly:</p>
<p><div class="highlight"><pre><span></span><code>http<span class="w"> </span>localhost:8080/trees/5f8c8266f1d33aa1012f3083
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>HTTP/1.1 200 OK
content-length: 94
content-type: application/json
date: Sun, 18 Oct 2020 22:06:52 GMT
server: uvicorn

{
    &quot;average_size&quot;: 5.0,
<span class="hll">    &quot;discovery_year&quot;: 1825,
</span>    &quot;id&quot;: &quot;5f8c8266f1d33aa1012f3083&quot;,
<span class="hll">    &quot;name&quot;: &quot;Stone Pine&quot;
</span>}
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Update the tree identified by <code>5f8c8266f1d33aa1012f3083</code>:
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-X<span class="w"> </span>PATCH<span class="w"> </span><span class="s2">&quot;http://localhost:8080/trees/5f8c8266f1d33aa1012f3083&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w">  </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;name&quot;:&quot;Stone Pine&quot;, &quot;discovery_year&quot;:1825}&#39;</span>
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>{&quot;name&quot;:&quot;Stone Pine&quot;,&quot;average_size&quot;:5.0,&quot;discovery_year&quot;:1825,&quot;id&quot;:&quot;5f8c8266f1d33aa1012f3083&quot;}
</code></pre></div>
Check that the tree has been updated properly:
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>http://localhost:8080/trees/5f8c8266f1d33aa1012f3083
</code></pre></div>
Output:
<div class="highlight"><pre><span></span><code>{&quot;name&quot;:&quot;Stone Pine&quot;,&quot;average_size&quot;:5.0,&quot;discovery_year&quot;:1825,&quot;id&quot;:&quot;5f8c8266f1d33aa1012f3083&quot;}
</code></pre></div></p>
</div>
</div>
</div>
<p>The tree has been updated successfully !</p>
</div>
<h2 id="upcoming-features">Upcoming features<a class="headerlink" href="#upcoming-features" title="Permanent link">&para;</a></h2>
<p>A lot of feature could still improve the ODMantic + FastAPI experience.</p>
<p>Some ideas that should arrive soon:</p>
<ul>
<li>Add a <code>not_found_exception</code> argument to the AIOEngine.find_one method. Thus, if the
  document is not found an exception will be raised directly.</li>
<li>Implement the equivalent of MongoDB insert method to be able to create document
  without overwriting existing ones.</li>
<li><del>Implement a Model.model_update method to update the model fields from a dictionnary or from
  a Pydantic schema.</del></li>
<li>Automatically generate CRUD endpoints directly from an ODMantic Model.</li>
</ul>









  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/art049" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/art049" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/arthur-pastel-a08579112" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["instant", "content.tabs.link"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.bd41221c.min.js"></script>
      
        <script src="../js/gitter.js"></script>
      
        <script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script>
      
    
  </body>
</html>