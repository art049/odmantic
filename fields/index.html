
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="AsyncIO MongoDB ODM (Object Document Mapper) using python type hinting">
      
      
      
      
        <link rel="canonical" href="https://art049.github.io/odmantic/fields/">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.4">
    
    
      
        <title>Fields - ODMantic</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.77f3fd56.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#8bc34b">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/extra.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-180814888-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="light-green" data-md-color-accent="light-green">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#fields" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://art049.github.io/odmantic/" title="ODMantic" class="md-header__button md-logo" aria-label="ODMantic">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.5 9.63c-.19-2.79-1.32-5.51-3.44-7.63A12.253 12.253 0 0 0 8.5 9.63c1.29.68 2.47 1.56 3.5 2.63a14.22 14.22 0 0 1 3.5-2.63M12 15.45C9.85 12.17 6.18 10 2 10c0 10 9.32 11.89 10 12 .68-.12 10-2 10-12-4.18 0-7.85 2.17-10 5.45z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ODMantic
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Fields
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/art049/odmantic/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    art049/odmantic
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://art049.github.io/odmantic/" title="ODMantic" class="md-nav__button md-logo" aria-label="ODMantic">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.5 9.63c-.19-2.79-1.32-5.51-3.44-7.63A12.253 12.253 0 0 0 8.5 9.63c1.29.68 2.47 1.56 3.5 2.63a14.22 14.22 0 0 1 3.5-2.63M12 15.45C9.85 12.17 6.18 10 2 10c0 10 9.32 11.89 10 12 .68-.12 10-2 10-12-4.18 0-7.85 2.17-10 5.45z"/></svg>

    </a>
    ODMantic
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/art049/odmantic/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    art049/odmantic
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Fields
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Fields
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-id-field" class="md-nav__link">
    The id field
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#field-types" class="md-nav__link">
    Field types
  </a>
  
    <nav class="md-nav" aria-label="Field types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optional-fields" class="md-nav__link">
    Optional fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#union-fields" class="md-nav__link">
    Union fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enum-fields" class="md-nav__link">
    Enum fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container-fields" class="md-nav__link">
    Container fields
  </a>
  
    <nav class="md-nav" aria-label="Container fields">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list" class="md-nav__link">
    List
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tuple" class="md-nav__link">
    Tuple
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict" class="md-nav__link">
    Dict
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bson-types-integration" class="md-nav__link">
    BSON types integration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic-fields" class="md-nav__link">
    Pydantic fields
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customization" class="md-nav__link">
    Customization
  </a>
  
    <nav class="md-nav" aria-label="Customization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-values" class="md-nav__link">
    Default values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#document-structure" class="md-nav__link">
    Document structure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#primary-key" class="md-nav__link">
    Primary key
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validation" class="md-nav__link">
    Validation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-field-types" class="md-nav__link">
    Custom field types
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../modeling/" class="md-nav__link">
        Modeling
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../engine/" class="md-nav__link">
        Engine
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../querying/" class="md-nav__link">
        Querying
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../raw_query_usage/" class="md-nav__link">
        Raw query usage
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../usage_fastapi/" class="md-nav__link">
        Usage with FastAPI
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../usage_pydantic/" class="md-nav__link">
        Usage with Pydantic
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      <label class="md-nav__link" for="__nav_9">
        API Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/model/" class="md-nav__link">
        odmantic.model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/engine/" class="md-nav__link">
        odmantic.engine
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/query/" class="md-nav__link">
        odmantic.query
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/field/" class="md-nav__link">
        odmantic.field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/reference/" class="md-nav__link">
        odmantic.reference
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/bson/" class="md-nav__link">
        odmantic.bson
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/fastapi/" class="md-nav__link">
        odmantic.fastapi
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/exceptions/" class="md-nav__link">
        odmantic.exceptions
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-id-field" class="md-nav__link">
    The id field
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#field-types" class="md-nav__link">
    Field types
  </a>
  
    <nav class="md-nav" aria-label="Field types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optional-fields" class="md-nav__link">
    Optional fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#union-fields" class="md-nav__link">
    Union fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enum-fields" class="md-nav__link">
    Enum fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container-fields" class="md-nav__link">
    Container fields
  </a>
  
    <nav class="md-nav" aria-label="Container fields">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list" class="md-nav__link">
    List
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tuple" class="md-nav__link">
    Tuple
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict" class="md-nav__link">
    Dict
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bson-types-integration" class="md-nav__link">
    BSON types integration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic-fields" class="md-nav__link">
    Pydantic fields
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customization" class="md-nav__link">
    Customization
  </a>
  
    <nav class="md-nav" aria-label="Customization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-values" class="md-nav__link">
    Default values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#document-structure" class="md-nav__link">
    Document structure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#primary-key" class="md-nav__link">
    Primary key
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validation" class="md-nav__link">
    Validation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-field-types" class="md-nav__link">
    Custom field types
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/art049/odmantic/edit/master/docs/fields.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="fields">Fields<a class="headerlink" href="#fields" title="Permanent link">&para;</a></h1>
<h2 id="the-id-field">The <code>id</code> field<a class="headerlink" href="#the-id-field" title="Permanent link">&para;</a></h2>
<p>The <a href="https://docs.mongodb.com/manual/reference/method/ObjectId/" target="blank_"><code>ObjectId</code> data type</a>
 is the default primary key type used by MongoDB. An <code>ObjectId</code> comes with many
 information embedded into it (timestamp, machine identifier, ...). Since by default
 MongoDB will create a field <code>_id</code> containing an <code>ObjectId</code> primary key, ODMantic will
 bind it automatically to an implicit field named <code>id</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">Player</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>


<span class="n">leeroy</span> <span class="o">=</span> <span class="n">Player</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Leeroy Jenkins&quot;</span><span class="p">)</span>
<span class="hll"><span class="nb">print</span><span class="p">(</span><span class="n">leeroy</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span class="hll"><span class="c1">#&gt; ObjectId(&#39;5ed50fcad11d1975aa3d7a28&#39;)</span>
</span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">leeroy</span><span class="p">))</span>
<span class="c1">#&gt; Player(id=ObjectId(&#39;5ed50fcad11d1975aa3d7a28&#39;), name=&quot;Leeroy Jenkins&quot;)</span>
</code></pre></div>
</td></tr></table>
<div class="admonition info">
<p class="admonition-title">ObjectId creation</p>
<p>This <code>id</code> field will be generated on instance creation, before saving the instance
to the database. This helps to keep consistency between the instances persisted to
the database and the ones only created locally.</p>
</div>
<p>Even if this behavior is convenient, it is still possible to <a href="#primary-key">define custom primary
keys</a>.</p>
<h2 id="field-types">Field types<a class="headerlink" href="#field-types" title="Permanent link">&para;</a></h2>
<h3 id="optional-fields">Optional fields<a class="headerlink" href="#optional-fields" title="Permanent link">&para;</a></h3>
<p>By default, every single field will be required. To specify a field as non-required, the
easiest way is to use the <code>typing.Optional</code> generic type that will allow the field to
take the <code>None</code> value as well (it will be stored as <code>null</code> in the database).</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="hll">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</span>
<span class="n">john</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;John&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">john</span><span class="o">.</span><span class="n">age</span><span class="p">)</span>
<span class="c1">#&gt; None</span>
</code></pre></div>
</td></tr></table>
<h3 id="union-fields">Union fields<a class="headerlink" href="#union-fields" title="Permanent link">&para;</a></h3>
<p>As explained in the <a href="https://docs.python.org/3/library/typing.html#typing.Optional" target="bank_">Python Typing
documentation</a>,
<code>Optional[X]</code> is equivalent to <code>Union[X, None]</code>. That implies that the field type will
be either <code>X</code> or <code>None</code>.</p>
<p>It's possible to combine any kind of type using the <code>typ√Æng.Union</code> type constructor. For
example if we want to allow both <code>string</code> and <code>int</code> in a field:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">Thing</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="hll">    <span class="n">ref_id</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
</span>

<span class="n">thing_1</span> <span class="o">=</span> <span class="n">Thing</span><span class="p">(</span><span class="n">ref_id</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">thing_1</span><span class="o">.</span><span class="n">ref_id</span><span class="p">)</span>
<span class="c1">#&gt; 42</span>

<span class="n">thing_2</span> <span class="o">=</span> <span class="n">Thing</span><span class="p">(</span><span class="n">ref_id</span><span class="o">=</span><span class="s2">&quot;i am a string&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">thing_2</span><span class="o">.</span><span class="n">ref_id</span><span class="p">)</span>
<span class="c1">#&gt; i am a string</span>
</code></pre></div>
</td></tr></table>
<div class="admonition question">
<p class="admonition-title">NoneType</p>
<p>Internally python describes the type of the <code>None</code> object as <code>NoneType</code> but in
practice, <code>None</code> is used directly in type annotations (<a href="https://mypy.readthedocs.io/en/stable/kinds_of_types.html#optional-types-and-the-none-type" target="bank_">more details</a>).</p>
</div>
<h3 id="enum-fields">Enum fields<a class="headerlink" href="#enum-fields" title="Permanent link">&para;</a></h3>
<p>To define choices, it's possible to use the standard <code>enum</code> classes:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>

<span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">AIOEngine</span><span class="p">,</span> <span class="n">Model</span>


<span class="hll"><span class="k">class</span> <span class="nc">TreeKind</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
</span><span class="hll">    <span class="n">BIG</span> <span class="o">=</span> <span class="s2">&quot;big&quot;</span>
</span><span class="hll">    <span class="n">SMALL</span> <span class="o">=</span> <span class="s2">&quot;small&quot;</span>
</span>

<span class="k">class</span> <span class="nc">Tree</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="hll">    <span class="n">kind</span><span class="p">:</span> <span class="n">TreeKind</span>
</span>

<span class="n">sequoia</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Sequoia&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">TreeKind</span><span class="o">.</span><span class="n">BIG</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sequoia</span><span class="o">.</span><span class="n">kind</span><span class="p">)</span>
<span class="c1">#&gt; TreeKind.BIG</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sequoia</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;big&quot;</span><span class="p">)</span>
<span class="c1">#&gt; True</span>

<span class="n">spruce</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spruce&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spruce</span><span class="o">.</span><span class="n">kind</span><span class="p">)</span>
<span class="c1">#&gt; TreeKind.SMALL</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spruce</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="n">TreeKind</span><span class="o">.</span><span class="n">SMALL</span><span class="p">)</span>
<span class="c1">#&gt; True</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">AIOEngine</span><span class="p">()</span>
<span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">save_all</span><span class="p">([</span><span class="n">sequoia</span><span class="p">,</span> <span class="n">spruce</span><span class="p">])</span>
</code></pre></div>
</td></tr></table>
<div class="admonition abstract">
<p class="admonition-title">Resulting documents in the collection <code>tree</code> after execution</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span> <span class="nt">&quot;_id&quot;</span> <span class="p">:</span> <span class="err">Objec</span><span class="kc">t</span><span class="err">Id(</span><span class="s2">&quot;5f818f2dd5708527282c49b6&quot;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&quot;kind&quot;</span> <span class="p">:</span> <span class="s2">&quot;big&quot;</span><span class="p">,</span> <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;Sequoia&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="nt">&quot;_id&quot;</span> <span class="p">:</span> <span class="err">Objec</span><span class="kc">t</span><span class="err">Id(</span><span class="s2">&quot;5f818f2dd5708527282c49b7&quot;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&quot;kind&quot;</span> <span class="p">:</span> <span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;Spruce&quot;</span> <span class="p">}</span>
</code></pre></div>
</div>
<p>If you try to use a value not present in the allowed choices, a <a href="https://pydantic-docs.helpmanual.io/usage/models/#error-handling" target="blank_">ValidationError</a> exception will be raised.</p>
<div class="admonition warning">
<p class="admonition-title">Usage of <code>enum.auto</code></p>
<p>If you might add some values to an <code>Enum</code>, it's strongly recommended not to use the
<code>enum.auto</code> value generator. Depending on the order you add choices, it could
completely break the consistency with documents stored in the database.</p>
<details class="example"><summary>Unwanted behavior example</summary><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">auto</span>


<span class="k">class</span> <span class="nc">Color</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">RED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">BLUE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>


<span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="c1">#&gt; 1</span>
<span class="hll"><span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">BLUE</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span class="hll"><span class="c1">#&gt; 2</span>
</span></code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">auto</span>


<span class="k">class</span> <span class="nc">Color</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">RED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
<span class="hll">    <span class="n">GREEN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
</span>    <span class="n">BLUE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>


<span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="c1">#&gt; 1</span>
<span class="hll"><span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">GREEN</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span class="hll"><span class="c1">#&gt; 2</span>
</span><span class="hll"><span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">BLUE</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span class="hll"><span class="c1">#&gt; 3</span>
</span></code></pre></div>
</td></tr></table>
</details>
</div>
<h3 id="container-fields">Container fields<a class="headerlink" href="#container-fields" title="Permanent link">&para;</a></h3>
<h4 id="list">List<a class="headerlink" href="#list" title="Permanent link">&para;</a></h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">SimpleListModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">field</span><span class="p">:</span> <span class="nb">list</span>


<span class="nb">print</span><span class="p">(</span><span class="n">SimpleListModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; [1, &#39;a&#39;, True]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">SimpleListModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; [1, &#39;a&#39;, True]</span>


<span class="k">class</span> <span class="nc">IntListModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">field</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>


<span class="nb">print</span><span class="p">(</span><span class="n">IntListModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; [1, 5]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">IntListModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; [1, 5]</span>


<span class="k">class</span> <span class="nc">IntStrListModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">field</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>


<span class="nb">print</span><span class="p">(</span><span class="n">IntStrListModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; [1, &#39;b&#39;]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">IntStrListModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; [1, &#39;b&#39;]</span>
</code></pre></div>
</td></tr></table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It's possible to define element count constraints for a list field using the
<a href="../api_reference/field/#odmantic.field.Field">Field</a> descriptor.</p>
</div>
<h4 id="tuple">Tuple<a class="headerlink" href="#tuple" title="Permanent link">&para;</a></h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span>

<span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">SimpleTupleModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">field</span><span class="p">:</span> <span class="nb">tuple</span>


<span class="nb">print</span><span class="p">(</span><span class="n">SimpleTupleModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; (1, &#39;a&#39;, True)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">SimpleTupleModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; (1, &#39;a&#39;, True)</span>


<span class="k">class</span> <span class="nc">TwoIntTupleModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">field</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>


<span class="nb">print</span><span class="p">(</span><span class="n">SimpleTupleModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; (1, 10)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">SimpleTupleModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; (1, 10)</span>


<span class="k">class</span> <span class="nc">IntTupleModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">field</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>


<span class="nb">print</span><span class="p">(</span><span class="n">IntTupleModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; (1,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">IntTupleModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; (1, 2, 3, 10)</span>
</code></pre></div>
</td></tr></table>
<h4 id="dict">Dict<a class="headerlink" href="#dict" title="Permanent link">&para;</a></h4>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For mapping types with already known keys, you can see the <a href="../modeling/#embedded-models">embedded models
section</a>.</p>
</div>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">SimpleDictModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">field</span><span class="p">:</span> <span class="nb">dict</span>


<span class="nb">print</span><span class="p">(</span><span class="n">SimpleDictModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">{</span><span class="mi">18</span><span class="p">:</span> <span class="s2">&quot;a string&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="mf">18.3</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; {18: &#39;a string&#39;, True: 42, 18.3: [1, 2, 3]}</span>


<span class="k">class</span> <span class="nc">IntStrDictModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">field</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>


<span class="nb">print</span><span class="p">(</span><span class="n">IntStrDictModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;two&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; {1: &#39;one&#39;, 2: &#39;two&#39;}</span>


<span class="k">class</span> <span class="nc">IntBoolStrDictModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">field</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>


<span class="nb">print</span><span class="p">(</span><span class="n">IntBoolStrDictModel</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;three&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; {0: False, 1: True, 3: &#39;three&#39;}</span>
</code></pre></div>
</td></tr></table>
<div class="admonition tip">
<p class="admonition-title">Performance tip</p>
<p>Whenever possible, try to avoid mutable container types (<code>List</code>, <code>Set</code>, ...) and
prefer their Immutable alternatives (<code>Tuple</code>, <code>FrozenSet</code>, ...). This will allow
ODMantic to speedup database writes by only saving the modified container fields.</p>
</div>
<h3 id="bson-types-integration"><code>BSON</code> types integration<a class="headerlink" href="#bson-types-integration" title="Permanent link">&para;</a></h3>
<p>ODMantic supports native python BSON types (<a href="https://api.mongodb.com/python/current/api/bson/index.html" target="blank_"><code>bson</code>
package</a>).
Those types can be used directly as field types:</p>
<ul>
<li>
<p><a href="https://api.mongodb.com/python/current/api/bson/objectid.html" target="blank_"><code>bson.ObjectId</code></a></p>
</li>
<li>
<p><a href="https://api.mongodb.com/python/current/api/bson/int64.html" target="blank_"><code>bson.Int64</code></a></p>
</li>
<li>
<p><a href="https://api.mongodb.com/python/current/api/bson/decimal128.html" target="blank_"><code>bson.Decimal128</code></a></p>
</li>
<li>
<p><a href="https://api.mongodb.com/python/current/api/bson/regex.html" target="blank_"><code>bson.Regex</code></a></p>
</li>
<li>
<p><a href="https://api.mongodb.com/python/current/api/bson/binary.html#bson.binary.Binary" target="blank_"><code>bson.Binary</code></a></p>
</li>
</ul>
<details class="info"><summary>Generic python to BSON type map</summary><table>
<thead>
<tr>
<th>Python type</th>
<th align="center">BSON type</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bson.ObjectId</code></td>
<td align="center"><code>objectId</code></td>
<td></td>
</tr>
<tr>
<td><code>bool</code></td>
<td align="center"><code>bool</code></td>
<td></td>
</tr>
<tr>
<td><code>int</code></td>
<td align="center"><code>int</code></td>
<td>value between -2^31 and 2^31 - 1</td>
</tr>
<tr>
<td><code>int</code></td>
<td align="center"><code>long</code></td>
<td>value not between -2^31 and 2^31 - 1</td>
</tr>
<tr>
<td><code>bson.Int64</code></td>
<td align="center"><code>long</code></td>
<td></td>
</tr>
<tr>
<td><code>float</code></td>
<td align="center"><code>double</code></td>
<td></td>
</tr>
<tr>
<td><code>bson.Decimal128</code></td>
<td align="center"><code>decimal</code></td>
<td></td>
</tr>
<tr>
<td><code>decimal.Decimal</code></td>
<td align="center"><code>decimal</code></td>
<td></td>
</tr>
<tr>
<td><code>str</code></td>
<td align="center"><code>string</code></td>
<td></td>
</tr>
<tr>
<td><code>typing.Pattern</code></td>
<td align="center"><code>regex</code></td>
<td></td>
</tr>
<tr>
<td><code>bson.Regex</code></td>
<td align="center"><code>regex</code></td>
<td></td>
</tr>
<tr>
<td><code>bytes</code></td>
<td align="center"><code>binData</code></td>
<td></td>
</tr>
<tr>
<td><code>bson.Binary</code></td>
<td align="center"><code>binData</code></td>
<td></td>
</tr>
<tr>
<td><code>datetime.datetime</code></td>
<td align="center"><code>date</code></td>
<td>microseconds are truncated, only naive datetimes are allowed</td>
</tr>
<tr>
<td><code>typing.Dict</code></td>
<td align="center"><code>object</code></td>
<td></td>
</tr>
<tr>
<td><code>typing.List</code></td>
<td align="center"><code>array</code></td>
<td></td>
</tr>
<tr>
<td><code>typing.Sequence</code></td>
<td align="center"><code>array</code></td>
<td></td>
</tr>
<tr>
<td><code>typing.Tuple[T, ...]</code></td>
<td align="center"><code>array</code></td>
<td></td>
</tr>
</tbody>
</table>
</details>
<h3 id="pydantic-fields">Pydantic fields<a class="headerlink" href="#pydantic-fields" title="Permanent link">&para;</a></h3>
<p>Most of the types supported by pydantic are supported by ODMantic. See <a href="https://pydantic-docs.helpmanual.io/usage/types" target="bank_">pydantic:
Field Types</a> for more
field types.</p>
<p>Unsupported fields:</p>
<ul>
<li><code>typing.Callable</code></li>
</ul>
<p>Fields with a specific behavior:</p>
<ul>
<li><code>datetime.datetime</code>: Only <a href="https://docs.python.org/3/library/datetime.html#determining-if-an-object-is-aware-or-naive" target="blank_">naive datetime
  objects</a>
  will be allowed as MongoDB doesn't store the timezone information. Also, the
  microsecond information will be truncated.</li>
</ul>
<h2 id="customization">Customization<a class="headerlink" href="#customization" title="Permanent link">&para;</a></h2>
<p>The field customization can mainly be performed using the <a href="../api_reference/field/#odmantic.field.Field">Field</a>
descriptor. This descriptor is here to define everything about the field except its
type.</p>
<h3 id="default-values">Default values<a class="headerlink" href="#default-values" title="Permanent link">&para;</a></h3>
<p>The easiest way to set a default value to a field is by assigning this default value
directly while defining the model.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">Player</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="hll">    <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Player</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dash&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="c1">#&gt; Player(id=ObjectId(&#39;5f7cd4be16af832772f1615e&#39;), name=&#39;Dash&#39;, level=0)</span>
</code></pre></div>
</td></tr></table>
<p>You can combine default values and an existing <a href="../api_reference/field/#odmantic.field.Field">Field</a>
descriptor using the <code>default</code> keyword argument.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">Player</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="hll">    <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Player</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dash&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="c1">#&gt; Player(id=ObjectId(&#39;5f7cdbfbb54a94e9e8717c77&#39;), name=&#39;Dash&#39;, level=1)</span>
</code></pre></div>
</td></tr></table>
<div class="admonition info">
<p class="admonition-title">Default factory</p>
<p>You may as well define a factory function instead of a value using the
<code>default_factory</code> argument of the <a href="../api_reference/field/#odmantic.field.Field">Field</a> descriptor.</p>
<p>By default, the default factories won't be used while parsing MongoDB documents.
It's possible to enable this behavior with the <code>parse_doc_with_default_factories</code>
<a href="../modeling/#advanced-configuration">Config</a> option.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For <code>typing.Optional</code> fields, <code>None</code> is already set as the default value</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Default values validation</p>
<p>Currently the default values are not validated yet during the model creation.</p>
<p>An inconsistent default value might raise a
<a href="https://pydantic-docs.helpmanual.io/usage/models/#error-handling" target="blank_">ValidationError</a>
while building an instance.</p>
</div>
<h3 id="document-structure">Document structure<a class="headerlink" href="#document-structure" title="Permanent link">&para;</a></h3>
<p>By default, the MongoDB documents fields will be named after the field name. It is
possible to override this naming policy by using the <code>key_name</code> argument in the
<a href="../api_reference/field/#odmantic.field.Field">Field</a> descriptor.
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">AIOEngine</span><span class="p">,</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">Player</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="hll">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">key_name</span><span class="o">=</span><span class="s2">&quot;username&quot;</span><span class="p">)</span>
</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">AIOEngine</span><span class="p">()</span>
<span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">Player</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Jack&quot;</span><span class="p">))</span>
</code></pre></div>
</td></tr></table></p>
<div class="admonition abstract">
<p class="admonition-title">Resulting documents in the collection <code>player</code> after execution</p>
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
  <span class="nt">&quot;_id&quot;</span><span class="p">:</span> <span class="err">Objec</span><span class="kc">t</span><span class="err">Id(</span><span class="s2">&quot;5ed50fcad11d1975aa3d7a28&quot;</span><span class="err">)</span><span class="p">,</span>
<span class="hll">  <span class="nt">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;Jack&quot;</span><span class="p">,</span>
</span><span class="p">}</span>
</code></pre></div>
See <a href="#the-id-field">this section</a> for more details about the <code>_id</code> field that has been added.</p>
</div>
<h3 id="primary-key">Primary key<a class="headerlink" href="#primary-key" title="Permanent link">&para;</a></h3>
<p>While ODMantic will by default populate the <code>id</code> field as a primary key, you can use any
other field as the primary key.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">AIOEngine</span><span class="p">,</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">Player</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">primary_field</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">leeroy</span> <span class="o">=</span> <span class="n">Player</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Leeroy Jenkins&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">leeroy</span><span class="p">))</span>
<span class="c1">#&gt; Player(name=&quot;Leeroy Jenkins&quot;)</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">AIOEngine</span><span class="p">()</span>
<span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">leeroy</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="admonition abstract">
<p class="admonition-title">Resulting documents in the collection <code>player</code> after execution</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;Leeroy Jenkins&quot;</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The Mongo name of the primary field will be enforced to <code>_id</code> and you will not be
able to change it.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using mutable types (Set, List, ...) as primary field might result in inconsistent
behaviors.</p>
</div>
<h2 id="validation">Validation<a class="headerlink" href="#validation" title="Permanent link">&para;</a></h2>
<p>As ODMantic strongly relies on pydantic when it comes to data validation, most of the
validation features provided by pydantic are available:</p>
<ul>
<li>
<p>Add field validation constraints by using the <a href="../api_reference/field/#odmantic.field.Field">Field descriptor</a>
  <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">ExampleModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">small_int</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">le</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">big_int</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">even_int</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">multiple_of</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">small_float</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">lt</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">big_float</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="mf">1e10</span><span class="p">)</span>

    <span class="n">short_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">long_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">string_starting_with_the</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;^The&quot;</span><span class="p">)</span>

    <span class="n">short_str_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">max_items</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">long_str_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">min_items</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</code></pre></div>
</td></tr></table></p>
</li>
<li>
<p>Use strict types to prevent to coercion from compatible types (<a href="https://pydantic-docs.helpmanual.io/usage/types/#strict-types" target="blank_">pydantic: Strict Types</a>)
  <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">StrictBool</span><span class="p">,</span> <span class="n">StrictFloat</span><span class="p">,</span> <span class="n">StrictStr</span>

<span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">ExampleModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">strict_bool</span><span class="p">:</span> <span class="n">StrictBool</span>
    <span class="n">strict_float</span><span class="p">:</span> <span class="n">StrictFloat</span>
    <span class="n">strict_str</span><span class="p">:</span> <span class="n">StrictStr</span>
</code></pre></div>
</td></tr></table></p>
</li>
<li>
<p>Define custom field validators (<a href="https://pydantic-docs.helpmanual.io/usage/validators/" target="blank_">pydantic:
  Validators</a>)
  <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">ClassVar</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">ValidationError</span><span class="p">,</span> <span class="n">validator</span>

<span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">SmallRectangle</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">MAX_SIDE_SIZE</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">length</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">float</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;length&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">check_small_sides</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="bp">cls</span><span class="o">.</span><span class="n">MAX_SIDE_SIZE</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;side is greater than </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">MAX_SIDE_SIZE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">check_width_length</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">length</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;length&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">width</span> <span class="o">&gt;</span> <span class="n">length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;width can&#39;t be greater than length&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">width</span>


<span class="nb">print</span><span class="p">(</span><span class="n">SmallRectangle</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="c1">#&gt; id=ObjectId(&#39;5f81e3c073103f509f97e374&#39;), length=2.0, width=1.0</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">SmallRectangle</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for SmallRectangle</span>
<span class="sd">    width</span>
<span class="sd">      field required (type=value_error.missing)</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">SmallRectangle</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for SmallRectangle</span>
<span class="sd">    width</span>
<span class="sd">      width can&#39;t be greater than length (type=value_error)</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">SmallRectangle</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for SmallRectangle</span>
<span class="sd">    length</span>
<span class="sd">      side is greater than 10 (type=value_error)</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
</td></tr></table></p>
</li>
<li>
<p>Define custom model validators: <a href="../modeling/#custom-model-validators">more details</a></p>
</li>
</ul>
<h2 id="custom-field-types">Custom field types<a class="headerlink" href="#custom-field-types" title="Permanent link">&para;</a></h2>
<p>Exactly in the same way pydantic allows it, it's possible to define custom field types as well with ODMantic (<a href="https://pydantic-docs.helpmanual.io/usage/types/#custom-data-types" target="blank_">pydantic: Custom data types</a>).</p>
<p>Sometimes, it might be required to customize as well the field BSON serialization. In
order to do this, the field class will have to implement the <code>__bson__</code> class method.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">bson</span> <span class="kn">import</span> <span class="n">Binary</span>

<span class="kn">from</span> <span class="nn">odmantic</span> <span class="kn">import</span> <span class="n">AIOEngine</span><span class="p">,</span> <span class="n">Model</span>


<span class="k">class</span> <span class="nc">ASCIISerializedAsBinary</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">__get_validators__</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">yield</span> <span class="bp">cls</span><span class="o">.</span><span class="n">validate</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="hll">        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>  <span class="c1"># Handle data coming from MongoDB</span>
</span><span class="hll">            <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
</span>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;string required&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">isascii</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only ascii characters are allowed&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

<span class="hll">    <span class="nd">@classmethod</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">__bson__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span class="hll">        <span class="c1"># We can encode this string as ascii since it contains</span>
</span><span class="hll">        <span class="c1"># only ascii characters</span>
</span><span class="hll">        <span class="n">bytes_</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">bytes_</span>
</span>

<span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">field</span><span class="p">:</span> <span class="n">ASCIISerializedAsBinary</span>


<span class="n">engine</span> <span class="o">=</span> <span class="n">AIOEngine</span><span class="p">()</span>
<span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">Example</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s2">&quot;hello world&quot;</span><span class="p">))</span>
<span class="n">fetched</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">Example</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fetched</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
<span class="c1">#&gt; hello world</span>
</code></pre></div>
</td></tr></table>
<p>In this example, we decide to store string data manually encoded in the ASCII encoding.
The encoding is handled in the <code>__bson__</code> class method. On top of this, we handle the
decoding by attempting to decode <code>bytes</code> object in the <code>validate</code> method.</p>
<div class="admonition abstract">
<p class="admonition-title">Resulting documents in the collection <code>example</code> after execution</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
  <span class="nt">&quot;_id&quot;</span> <span class="p">:</span> <span class="err">Objec</span><span class="kc">t</span><span class="err">Id(</span><span class="s2">&quot;5f81fa5e8adaf4bf33f05035&quot;</span><span class="err">)</span><span class="p">,</span>
<span class="hll">  <span class="nt">&quot;field&quot;</span> <span class="p">:</span> <span class="err">Bi</span><span class="kc">n</span><span class="err">Da</span><span class="kc">ta</span><span class="err">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;aGVsbG8gd29ybGQ=&quot;</span><span class="err">)</span>
</span><span class="p">}</span>
</code></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When using custom bson serialization, it's important to handle as well the data
validation for data retrieved from Mongo. In the previous example it's done by
handling <code>bytes</code> objects in the validate method.</p>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href=".." class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Overview
            </div>
          </div>
        </a>
      
      
        <a href="../modeling/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Modeling
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/art049" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/art049" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/in/arthur-pastel-a08579112" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["instant"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.9b151c6a.min.js"></script>
      
        <script src="../js/gitter.js"></script>
      
        <script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script>
      
    
  </body>
</html>